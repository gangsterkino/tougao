"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[739],{99362:function(W,p,s){s.r(p);var b=s(15009),h=s.n(b),x=s(99289),C=s.n(x),M=s(5574),l=s.n(M),o=s(67294),t=s(80854),d=s(68872),O=s(2507),e=s(85893),U=function(){var D=(0,o.useState)(""),g=l()(D,2),c=g[0],B=g[1],T=(0,o.useState)(""),v=l()(T,2),E=v[0],A=v[1],R=(0,o.useState)("\u4F1A\u5458"),f=l()(R,2),y=f[0],L=f[1],j=(0,O.Z)(),I=j.updateUser,u=j.currentUser;(0,o.useEffect)(function(){u&&u.role!=="\u975E\u4F1A\u5458"&&(console.log("Updated currentUser:",u),u.role==="member"?t.history.push("/member/profile"):u.role==="editor"?t.history.push("/editor"):u.role==="admin"&&t.history.push("/admin"))},[u]);var K=function(){var _=C()(h()().mark(function r(){var P,a,m,i;return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,P={\u4F1A\u5458:"member",\u7F16\u8F91:"editor",\u7BA1\u7406\u5458:"admin"},a=P[y],console.log("\u89D2\u8272:",a),n.next=6,fetch("http://127.0.0.1:5000/api/user/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:c,password:E,role:a})});case 6:return m=n.sent,n.next=9,m.json();case 9:i=n.sent,m.ok?(d.ZP.success(i.message),I({name:i.username,role:a}),a==="member"?t.history.push("/member/profile"):a==="editor"?t.history.push("/editor"):a==="admin"&&t.history.push("/admin")):d.ZP.error(i.message||"\u767B\u5F55\u5931\u8D25"),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(0),d.ZP.error("\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");case 16:case"end":return n.stop()}},r,null,[[0,13]])}));return function(){return _.apply(this,arguments)}}(),S=function(){t.history.push("/register")};return(0,e.jsxs)("div",{style:{padding:"50px"},children:[(0,e.jsx)("h2",{children:"\u767B\u5F55"}),(0,e.jsx)("div",{style:{marginBottom:"20px"},children:(0,e.jsx)("input",{type:"text",value:c,onChange:function(r){return B(r.target.value)},placeholder:"\u7528\u6237\u540D",style:{width:"100%",padding:"8px"}})}),(0,e.jsx)("div",{style:{marginBottom:"20px"},children:(0,e.jsx)("input",{type:"password",value:E,onChange:function(r){return A(r.target.value)},placeholder:"\u5BC6\u7801",style:{width:"100%",padding:"8px"}})}),(0,e.jsx)("div",{style:{marginBottom:"20px"},children:(0,e.jsxs)("select",{value:y,onChange:function(r){return L(r.target.value)},style:{width:"100%",padding:"8px"},children:[(0,e.jsx)("option",{value:"\u4F1A\u5458",children:"\u4F1A\u5458"}),(0,e.jsx)("option",{value:"\u7F16\u8F91",children:"\u7F16\u8F91"}),(0,e.jsx)("option",{value:"\u7BA1\u7406\u5458",children:"\u7BA1\u7406\u5458"})]})}),(0,e.jsx)("button",{onClick:K,style:{padding:"10px 20px",marginBottom:"10px"},children:"\u767B\u5F55"}),(0,e.jsx)("div",{children:(0,e.jsx)("button",{onClick:S,style:{padding:"10px 20px"},children:"\u6CE8\u518C\u4F1A\u5458"})})]})};p.default=U}}]);
